{"ast":null,"code":"import _slicedToArray from\"/Users/licop/Documents/GitHub/LUI/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{jsx as _jsx}from\"react/jsx-runtime\";import React,{useState,createContext}from'react';import classNames from'classnames';export var MenuContext=/*#__PURE__*/createContext({index:'0'});var Menu=function Menu(props){var className=props.className,mode=props.mode,style=props.style,children=props.children,defaultIndex=props.defaultIndex,defaultOpenSubMenu=props.defaultOpenSubMenu,onSelect=props.onSelect;var classes=classNames('lui-menu',className,{'menu-vertical':mode==='vertical','menu-horizontal':mode==='horizontal'});var _useState=useState(defaultIndex),_useState2=_slicedToArray(_useState,2),currentActive=_useState2[0],setActive=_useState2[1];var handleClick=function handleClick(index){setActive(index);if(onSelect){onSelect(index);}};var passContext={index:currentActive?currentActive:'0',mode:mode,defaultOpenSubMenu:defaultOpenSubMenu,onSelect:handleClick};var renderChildren=function renderChildren(){return React.Children.map(children,function(child,index){var childElement=child;var displayName=childElement.type.displayName;if(displayName==='MenuItem'||displayName==='SubMenu'){return/*#__PURE__*/React.cloneElement(childElement,{index:index.toString()});}else{console.error(\"Warning: Menu has a child which is not a MenuItem component\");}});};return/*#__PURE__*/_jsx(\"ul\",{className:classes,style:style,\"data-testid\":\"test-menu\",children:/*#__PURE__*/_jsx(MenuContext.Provider,{value:passContext,children:renderChildren()})});};Menu.defaultProps={defaultIndex:'0',mode:'horizontal',defaultOpenSubMenu:[]};export default Menu;","map":{"version":3,"sources":["/Users/licop/Documents/GitHub/LUI/src/components/Menu/Menu.tsx"],"names":["React","useState","createContext","classNames","MenuContext","index","Menu","props","className","mode","style","children","defaultIndex","defaultOpenSubMenu","onSelect","classes","currentActive","setActive","handleClick","passContext","renderChildren","Children","map","child","childElement","displayName","type","cloneElement","toString","console","error","defaultProps"],"mappings":"mMAAA,MAAOA,CAAAA,KAAP,EAAeC,QAAf,CAAyBC,aAAzB,KAA6C,OAA7C,CACA,MAAOC,CAAAA,UAAP,KAAuB,YAAvB,CAuBA,MAAO,IAAMC,CAAAA,WAAW,cAAGF,aAAa,CAAe,CAACG,KAAK,CAAE,GAAR,CAAf,CAAjC,CAEP,GAAMC,CAAAA,IAAyB,CAAG,QAA5BA,CAAAA,IAA4B,CAACC,KAAD,CAAW,IAClCC,CAAAA,SADkC,CAC8CD,KAD9C,CAClCC,SADkC,CACvBC,IADuB,CAC8CF,KAD9C,CACvBE,IADuB,CACjBC,KADiB,CAC8CH,KAD9C,CACjBG,KADiB,CACVC,QADU,CAC8CJ,KAD9C,CACVI,QADU,CACAC,YADA,CAC8CL,KAD9C,CACAK,YADA,CACcC,kBADd,CAC8CN,KAD9C,CACcM,kBADd,CACkCC,QADlC,CAC8CP,KAD9C,CACkCO,QADlC,CAEzC,GAAMC,CAAAA,OAAO,CAAGZ,UAAU,CAAC,UAAD,CAAaK,SAAb,CAAwB,CAC9C,gBAAiBC,IAAI,GAAK,UADoB,CAE9C,kBAAmBA,IAAI,GAAK,YAFkB,CAAxB,CAA1B,CAFyC,cAMNR,QAAQ,CAACW,YAAD,CANF,wCAMlCI,aANkC,eAMnBC,SANmB,eAOzC,GAAMC,CAAAA,WAAW,CAAG,QAAdA,CAAAA,WAAc,CAACb,KAAD,CAAmB,CACnCY,SAAS,CAACZ,KAAD,CAAT,CACA,GAAGS,QAAH,CAAa,CACTA,QAAQ,CAACT,KAAD,CAAR,CACH,CACJ,CALD,CAMA,GAAMc,CAAAA,WAAyB,CAAG,CAC9Bd,KAAK,CAAEW,aAAa,CAAGA,aAAH,CAAmB,GADT,CAE9BP,IAAI,CAAJA,IAF8B,CAG9BI,kBAAkB,CAAlBA,kBAH8B,CAI9BC,QAAQ,CAAEI,WAJoB,CAAlC,CAOA,GAAME,CAAAA,cAAc,CAAG,QAAjBA,CAAAA,cAAiB,EAAM,CACzB,MAAOpB,CAAAA,KAAK,CAACqB,QAAN,CAAeC,GAAf,CAAmBX,QAAnB,CAA6B,SAACY,KAAD,CAAQlB,KAAR,CAAkB,CAClD,GAAMmB,CAAAA,YAAY,CAAGD,KAArB,CADkD,GAE1CE,CAAAA,WAF0C,CAE1BD,YAAY,CAACE,IAFa,CAE1CD,WAF0C,CAGlD,GAAGA,WAAW,GAAK,UAAhB,EAA8BA,WAAW,GAAK,SAAjD,CAA4D,CACxD,mBAAOzB,KAAK,CAAC2B,YAAN,CAAmBH,YAAnB,CAAiC,CAACnB,KAAK,CAAEA,KAAK,CAACuB,QAAN,EAAR,CAAjC,CAAP,CACH,CAFD,IAEO,CACHC,OAAO,CAACC,KAAR,CAAc,6DAAd,EACH,CACJ,CARM,CAAP,CASH,CAVD,CAYA,mBACI,WAAI,SAAS,CAAEf,OAAf,CAAwB,KAAK,CAAEL,KAA/B,CAAsC,cAAY,WAAlD,uBACI,KAAC,WAAD,CAAa,QAAb,EAAsB,KAAK,CAAES,WAA7B,UACKC,cAAc,EADnB,EADJ,EADJ,CAOH,CAvCD,CAyCAd,IAAI,CAACyB,YAAL,CAAoB,CAChBnB,YAAY,CAAE,GADE,CAEhBH,IAAI,CAAE,YAFU,CAGhBI,kBAAkB,CAAE,EAHJ,CAApB,CAMA,cAAeP,CAAAA,IAAf","sourcesContent":["import React, {useState, createContext} from 'react';\nimport classNames from 'classnames';\nimport { MenuItemProps } from './MenuItem'\n\ntype MenuMode = 'horizontal' | 'vertical';\ntype SelectCallback = (selectedIndex: string) => void;\n\nexport interface MenuProps {\n    defaultIndex?: string,\n    className?: string,\n    /**\n     * 模式，选择垂直模式还是水平模式\n     */\n    mode?: MenuMode,\n    style?: React.CSSProperties,\n    defaultOpenSubMenu?: string[],\n    onSelect?: SelectCallback\n}\ninterface IMenuContext {\n    index: string,\n    mode?: MenuMode,\n    defaultOpenSubMenu?: string[],\n    onSelect?: SelectCallback\n}\nexport const MenuContext = createContext<IMenuContext>({index: '0'});\n\nconst Menu: React.FC<MenuProps> = (props) => {\n    const {className, mode, style, children, defaultIndex, defaultOpenSubMenu, onSelect} = props;\n    const classes = classNames('lui-menu', className, {\n        'menu-vertical': mode === 'vertical',\n        'menu-horizontal': mode === 'horizontal'\n    })\n    const [currentActive, setActive] = useState(defaultIndex);\n    const handleClick = (index: string) => {\n        setActive(index);\n        if(onSelect) {\n            onSelect(index);\n        }\n    }\n    const passContext: IMenuContext = {\n        index: currentActive ? currentActive : '0',\n        mode,\n        defaultOpenSubMenu,\n        onSelect: handleClick,\n        \n    }\n    const renderChildren = () => {\n        return React.Children.map(children, (child, index) => {\n            const childElement = child as React.FunctionComponentElement<MenuItemProps>\n            const { displayName } = childElement.type;\n            if(displayName === 'MenuItem' || displayName === 'SubMenu') {\n                return React.cloneElement(childElement, {index: index.toString()});\n            } else {\n                console.error(\"Warning: Menu has a child which is not a MenuItem component\")\n            }\n        })\n    }\n\n    return (\n        <ul className={classes} style={style} data-testid=\"test-menu\">\n            <MenuContext.Provider value={passContext}>\n                {renderChildren()}\n            </MenuContext.Provider>\n        </ul>\n    )\n}\n\nMenu.defaultProps = {\n    defaultIndex: '0',\n    mode: 'horizontal',\n    defaultOpenSubMenu: []\n}\n\nexport default Menu;\n"]},"metadata":{},"sourceType":"module"}